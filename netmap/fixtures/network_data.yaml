devices:
  - name: router1
    description: Core Router 1
    interfaces:
      - name: eth0
        ip_address: 10.0.0.1
        network: 10.0.0.0/24  # Connects to router2
        status: up
      - name: eth1
        ip_address: 172.16.0.1
        network: 172.16.0.0/24  # Connects to server1
        status: up
      - name: eth2
        ip_address: 192.168.1.1
        network: 192.168.1.0/24  # Connects to switch1
        status: up
      - name: eth3
        ip_address: 203.0.113.1
        network: 203.0.113.0/24  # Internet connection
        status: up
      - name: loopback0
        ip_address: 10.255.1.1
        network: 10.255.1.1/32   # Stub network (loopback)
        status: up
      - name: management0
        ip_address: 192.168.100.1
        network: 192.168.100.0/24  # Stub network (management)
        status: up
    routes:
      - destination_network: 10.0.0.0/24
        type: connected
        metric: 0
      - destination_network: 172.16.0.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.1.0/24
        type: connected
        metric: 0
      - destination_network: 203.0.113.0/24
        type: connected
        metric: 0
      - destination_network: 10.255.1.1/32
        type: connected
        metric: 0
      - destination_network: 192.168.100.0/24
        type: connected
        metric: 0
      - destination_network: 0.0.0.0/0
        gateway_ip: 203.0.113.254
        type: static
        metric: 1
      - destination_network: 10.1.0.0/24
        gateway_ip: 10.0.0.2
        type: ospf
        metric: 10
      - destination_network: 192.168.2.0/24
        gateway_ip: 10.0.0.2
        type: ospf
        metric: 20
      - destination_network: 10.2.0.0/24
        gateway_ip: 10.0.0.2
        type: ospf
        metric: 30
      # IMPORTANT: We deliberately DON'T include a route for 192.168.3.0/24 here
      # This will be our test case for routing failure
    nat_mappings:
      - logical_ip_or_network: 192.168.1.0/24
        real_ip_or_network: 203.0.113.100
        type: source
        description: Internal network 1 to internet
      - logical_ip_or_network: 203.0.113.80
        real_ip_or_network: 172.16.0.100
        type: destination
        description: Public IP to web server

  - name: router2
    description: Core Router 2
    interfaces:
      - name: eth0
        ip_address: 10.0.0.2
        network: 10.0.0.0/24  # Connects to router1
        status: up
      - name: eth1
        ip_address: 10.1.0.1
        network: 10.1.0.0/24  # Connects to router3
        status: up
      - name: eth2
        ip_address: 192.168.2.1
        network: 192.168.2.0/24  # Connects to switch2
        status: up
      - name: loopback0
        ip_address: 10.255.2.1
        network: 10.255.2.1/32  # Stub network (loopback)
        status: up
      - name: management0
        ip_address: 192.168.200.1
        network: 192.168.200.0/24  # Stub network (management)
        status: up
    routes:
      - destination_network: 10.0.0.0/24
        type: connected
        metric: 0
      - destination_network: 10.1.0.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.2.0/24
        type: connected
        metric: 0
      - destination_network: 10.255.2.1/32
        type: connected
        metric: 0
      - destination_network: 192.168.200.0/24
        type: connected
        metric: 0
      - destination_network: 0.0.0.0/0
        gateway_ip: 10.0.0.1
        type: static
        metric: 1
      - destination_network: 172.16.0.0/24
        gateway_ip: 10.0.0.1
        type: ospf
        metric: 10
      - destination_network: 192.168.1.0/24
        gateway_ip: 10.0.0.1
        type: ospf
        metric: 20
      - destination_network: 203.0.113.0/24
        gateway_ip: 10.0.0.1
        type: ospf
        metric: 30
      - destination_network: 10.2.0.0/24
        gateway_ip: 10.1.0.2
        type: ospf
        metric: 10
      - destination_network: 192.168.3.0/24
        gateway_ip: 10.1.0.2
        type: ospf
        metric: 20

  - name: router3
    description: Distribution Router
    interfaces:
      - name: eth0
        ip_address: 10.1.0.2
        network: 10.1.0.0/24  # Connects to router2
        status: up
      - name: eth1
        ip_address: 10.2.0.1
        network: 10.2.0.0/24  # Connects to unused network (stub)
        status: up
      - name: eth2
        ip_address: 192.168.3.1
        network: 192.168.3.0/24  # Connects to switch3
        status: up
      - name: loopback0
        ip_address: 10.255.3.1
        network: 10.255.3.1/32  # Stub network (loopback)
        status: up
      - name: management0
        ip_address: 192.168.210.1
        network: 192.168.210.0/24  # Stub network (management)
        status: up
    routes:
      - destination_network: 10.1.0.0/24
        type: connected
        metric: 0
      - destination_network: 10.2.0.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.3.0/24
        type: connected
        metric: 0
      - destination_network: 10.255.3.1/32
        type: connected
        metric: 0
      - destination_network: 192.168.210.0/24
        type: connected
        metric: 0
      - destination_network: 0.0.0.0/0
        gateway_ip: 10.1.0.1
        type: static
        metric: 1
      - destination_network: 10.0.0.0/24
        gateway_ip: 10.1.0.1
        type: ospf
        metric: 10
      - destination_network: 172.16.0.0/24
        gateway_ip: 10.1.0.1
        type: ospf
        metric: 20
      - destination_network: 192.168.1.0/24
        gateway_ip: 10.1.0.1
        type: ospf
        metric: 30
      - destination_network: 192.168.2.0/24
        gateway_ip: 10.1.0.1
        type: ospf
        metric: 20
      - destination_network: 203.0.113.0/24
        gateway_ip: 10.1.0.1
        type: ospf
        metric: 40
    nat_mappings:
      - logical_ip_or_network: 200.1.1.1
        real_ip_or_network: 192.168.3.100
        type: destination
        description: Public to server1

  - name: switch1
    description: Access Switch 1
    interfaces:
      - name: eth0
        ip_address: 192.168.1.2
        network: 192.168.1.0/24  # Connects to router1
        status: up
      - name: vlan10
        ip_address: 192.168.11.1
        network: 192.168.11.0/24  # Stub network (user VLAN 10)
        status: up
      - name: vlan20
        ip_address: 192.168.12.1
        network: 192.168.12.0/24  # Stub network (user VLAN 20)
        status: up
    routes:
      - destination_network: 192.168.1.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.11.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.12.0/24
        type: connected
        metric: 0
      - destination_network: 0.0.0.0/0
        gateway_ip: 192.168.1.1
        type: static
        metric: 1
      - destination_network: 10.0.0.0/24
        gateway_ip: 192.168.1.1
        type: static
        metric: 5
      - destination_network: 172.16.0.0/24
        gateway_ip: 192.168.1.1
        type: static
        metric: 5
      - destination_network: 10.1.0.0/24
        gateway_ip: 192.168.1.1
        type: static
        metric: 10
      - destination_network: 192.168.2.0/24
        gateway_ip: 192.168.1.1
        type: static
        metric: 10
      - destination_network: 10.2.0.0/24
        gateway_ip: 192.168.1.1
        type: static
        metric: 15
      - destination_network: 192.168.3.0/24
        gateway_ip: 192.168.1.1
        type: static
        metric: 15
      - destination_network: 203.0.113.0/24
        gateway_ip: 192.168.1.1
        type: static
        metric: 5

  - name: switch2
    description: Access Switch 2
    interfaces:
      - name: eth0
        ip_address: 192.168.2.2
        network: 192.168.2.0/24  # Connects to router2
        status: up
      - name: vlan10
        ip_address: 192.168.21.1
        network: 192.168.21.0/24  # Stub network (user VLAN 10)
        status: up
      - name: vlan20
        ip_address: 192.168.22.1
        network: 192.168.22.0/24  # Stub network (user VLAN 20)
        status: up
    routes:
      - destination_network: 192.168.2.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.21.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.22.0/24
        type: connected
        metric: 0
      - destination_network: 0.0.0.0/0
        gateway_ip: 192.168.2.1
        type: static
        metric: 1
      - destination_network: 10.0.0.0/24
        gateway_ip: 192.168.2.1
        type: static
        metric: 5
      - destination_network: 172.16.0.0/24
        gateway_ip: 192.168.2.1
        type: static
        metric: 10
      - destination_network: 10.1.0.0/24
        gateway_ip: 192.168.2.1
        type: static
        metric: 5
      - destination_network: 192.168.1.0/24
        gateway_ip: 192.168.2.1
        type: static
        metric: 10
      - destination_network: 10.2.0.0/24
        gateway_ip: 192.168.2.1
        type: static
        metric: 10
      - destination_network: 192.168.3.0/24
        gateway_ip: 192.168.2.1
        type: static
        metric: 10
      - destination_network: 203.0.113.0/24
        gateway_ip: 192.168.2.1
        type: static
        metric: 15

  - name: switch3
    description: Access Switch 3
    interfaces:
      - name: eth0
        ip_address: 192.168.3.2
        network: 192.168.3.0/24  # Connects to router3
        status: up
      - name: vlan10
        ip_address: 192.168.31.1
        network: 192.168.31.0/24  # Stub network (user VLAN 10)
        status: up
      - name: vlan20
        ip_address: 192.168.32.1
        network: 192.168.32.0/24  # Stub network (user VLAN 20)
        status: up
    routes:
      - destination_network: 192.168.3.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.31.0/24
        type: connected
        metric: 0
      - destination_network: 192.168.32.0/24
        type: connected
        metric: 0
      - destination_network: 0.0.0.0/0
        gateway_ip: 192.168.3.1
        type: static
        metric: 1
      - destination_network: 10.0.0.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 10
      - destination_network: 172.16.0.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 15
      - destination_network: 10.1.0.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 5
      - destination_network: 192.168.1.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 15
      - destination_network: 10.2.0.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 5
      - destination_network: 192.168.2.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 10
      - destination_network: 203.0.113.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 20

  - name: server1
    description: Web Server
    interfaces:
      - name: eth0
        ip_address: 172.16.0.100
        network: 172.16.0.0/24  # Connects to router1
        status: up
      - name: eth0:1
        ip_address: 172.16.0.101
        network: 172.16.0.0/24  # Virtual IP on same network
        status: up
      - name: backup0
        ip_address: 10.3.1.1
        network: 10.3.1.0/24  # Stub network (backup)
        status: up
    routes:
      - destination_network: 172.16.0.0/24
        type: connected
        metric: 0
      - destination_network: 10.3.1.0/24
        type: connected
        metric: 0
      - destination_network: 0.0.0.0/0
        gateway_ip: 172.16.0.1
        type: static
        metric: 1
      - destination_network: 10.0.0.0/24
        gateway_ip: 172.16.0.1
        type: static
        metric: 5
      - destination_network: 192.168.1.0/24
        gateway_ip: 172.16.0.1
        type: static
        metric: 10
      - destination_network: 10.1.0.0/24
        gateway_ip: 172.16.0.1
        type: static
        metric: 10
      - destination_network: 192.168.2.0/24
        gateway_ip: 172.16.0.1
        type: static
        metric: 15
      - destination_network: 10.2.0.0/24
        gateway_ip: 172.16.0.1
        type: static
        metric: 15
      - destination_network: 192.168.3.0/24
        gateway_ip: 172.16.0.1
        type: static
        metric: 20
      - destination_network: 203.0.113.0/24
        gateway_ip: 172.16.0.1
        type: static
        metric: 5

  - name: server2
    description: Database Server
    interfaces:
      - name: eth0
        ip_address: 192.168.3.100
        network: 192.168.3.0/24  # Connects to switch3/router3
        status: up
      - name: eth0:1
        ip_address: 192.168.3.101
        network: 192.168.3.0/24  # Virtual IP on same network
        status: up
      - name: backup0
        ip_address: 10.3.2.1
        network: 10.3.2.0/24  # Stub network (backup)
        status: up
    routes:
      - destination_network: 192.168.3.0/24
        type: connected
        metric: 0
      - destination_network: 10.3.2.0/24
        type: connected
        metric: 0
      - destination_network: 0.0.0.0/0
        gateway_ip: 192.168.3.1
        type: static
        metric: 1
      - destination_network: 10.0.0.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 10
      - destination_network: 172.16.0.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 15
      - destination_network: 10.1.0.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 5
      - destination_network: 192.168.1.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 15
      - destination_network: 10.2.0.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 5
      - destination_network: 192.168.2.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 10
      - destination_network: 203.0.113.0/24
        gateway_ip: 192.168.3.1
        type: static
        metric: 20